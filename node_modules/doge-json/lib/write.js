'use strict';
var __importDefault =
	(this && this.__importDefault) ||
	function (mod) {
		return mod && mod.__esModule ? mod : { default: mod };
	};
const normalize_and_encode_1 = require('./normalize-and-encode');
const fs_polyfill_1 = __importDefault(require('./fs-polyfill'));
const path_1 = __importDefault(require('path'));
/**
 * Write any object to a file as JSON
 * @param file Path to file
 * @param data Data you want to write
 */
function write(file, data) {
	if (!file.includes('.')) file = `${file}.json`;
	const directory = path_1.default.resolve(file, '..');
	if (!fs_polyfill_1.default.existsSync(directory))
		fs_polyfill_1.default.mkdirSync(directory, { recursive: true });
	const data_str = (0, normalize_and_encode_1.encode)(data);
	try {
		const current = fs_polyfill_1.default.readFileSync(file).toString();
		if (current === data_str) {
			return;
		}
	} catch (error) {
		// file probably doesn't exist
	}
	fs_polyfill_1.default.writeFileSync(file, data_str);
}
Object.defineProperties(write, {
	default: { get: () => write },
	write: { get: () => write },
});
module.exports = write;
