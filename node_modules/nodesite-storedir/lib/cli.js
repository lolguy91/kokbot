#!/usr/bin/env node
'use strict';
var __importDefault =
	(this && this.__importDefault) ||
	function (mod) {
		return mod && mod.__esModule ? mod : { default: mod };
	};
Object.defineProperty(exports, '__esModule', { value: true });
const nsblob_native_if_available_1 = __importDefault(
	require('nsblob-native-if-available')
);
const process_1 = require('process');
const serial_async_io_1 = require('serial-async-io');
const fetch_1 = require('./fetch');
const store_1 = require('./store');
const file = process_1.argv[2] || '.';
async function main() {
	const stats = await (0, serial_async_io_1.stat)(file);
	if (stats) {
		const hash = await (0, store_1.store)(file);
		console.log(hash);
	} else {
		await (0, fetch_1.fetch)(file, process_1.argv[3] || '.');
	}
	nsblob_native_if_available_1.default.socket.close();
}
main();
